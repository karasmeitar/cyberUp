<!DOCTYPE html>
<html>
   <head>
      <meta charset="UTF-8"/>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Cyberark@ AngularUp</title>
      <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
	   <link rel="stylesheet" href="css/common.css" type="text/css" /> 
	 
  </head>
<body>
<div id="cyb-loader" class="cyb-loader">
<div data-role="page" id="cyb-welcome-page" class="container">
	<img src="assets/images/logo.png" alt="CyberArk logo" class="cyb-logo">
	<div class="cyb-main-title ">click</div>
		<a href="#cyb-registration-form" class="cyb-main-title-clickable" data-transition="flip">here</a>
	<div class="cyb-main-title ">if you</div>
	<div class="cyb-main-title ">want</div>
	<div class="cyb-main-title ">to win</div>
	<img src="assets/images/men.png" alt="CyberArk cyber hero" class="cyb-main-avatar">
</div>


<div   data-role="page" id="cyb-registration-form">
<img src="assets/images/men_2.png" alt="CyberArk cyber hero2" class="cyb-regvatar">
<input type="text" placeholder= "first name" name="fname" class="cyb-user-firstname" 	data-wrapper-class="ui-custom">
<input type="text" placeholder= "last name" name="lastname" class="cyb-user-lastname" data-wrapper-class="ui-custom">
<input type="text" placeholder= "email" name="email" class="cyb-user-email" data-wrapper-class="ui-custom">
<input type="button" value="Submit" id="cyb-submit" data-wrapper-class="ui-custom">
<label class="error">*Please fill in all required field</label>
</div>

<div data-role="page" id="cyb-visit-us">
<img src="assets/images/logo.png" alt="CyberArk logo" class="cyb-logo">
<span class="cyb-thank-title">THANK YOU!</span>
<span class="cyb-subtitle">your code</span>
<span id="cyb-code" class="cyb-subtitle"></span>
<img src="assets/images/woman.png" alt="CyberArk cyber hero" class="cyb-woman-avatar">

</div>

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-XXXXX-Y', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->


<!-- Jquery-->
<script src="js/jquery-2.1.1.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<!-- Jquery -->

<!-- Bootstrap-->
<script src="js/bootstrap.min.js"></script>
<!-- Bootstrap-->


<script>
$( "#cyb-submit" ).click(function() {
	var isValid = true;
	var emailInput=$(".cyb-user-email");
	var re = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;
	var is_email=re.test(emailInput.val());
	if(is_email){
		removeErrorClass('.cyb-user-email');
	}
	else{
		isValid = false;
		addErrorClass('.cyb-user-email');
	}
	
	var first_name=$('.cyb-user-firstname').val();
	if(first_name){
		removeErrorClass('.cyb-user-firstname');
	}
	else{
	isValid = false;
		addErrorClass('.cyb-user-firstname');
	}
	
	var last_name=$('.cyb-user-lastname').val();
	if(last_name){
		removeErrorClass('.cyb-user-lastname');
	}
	else{
		isValid = false;
		addErrorClass('.cyb-user-lastname');
	}
	
	if(!isValid){
		$('.error').show();
	}
	else{
	
		var candidate = {};
		candidate['firstName']= $('.cyb-user-firstname').val();
		candidate['lastName']= $('.cyb-user-lastname').val();
		candidate['email']= $('.cyb-user-email').val();
		
		
		$('.error').hide();
		$.ajax({
			url: "http://localhost:8080/api/candidate",
			type: "POST",
			crossDomain: true,
			data: JSON.stringify(candidate),
			contentType:"application/json",
			dataType: "json",
			success:function(result){
				if(result.status==='error'){
					$('.error').text(result.message);
					$('.error').show();
				}
				else{
					$('#cyb-code').text(result.message);
					$.mobile.navigate('#cyb-visit-us')
				}
			},
			error:function(xhr,status,error){
					$('.error').text(error);
					$('.error').show();
			}
		});
	}
});

function addErrorClass(objectClass){
	$(objectClass).parent().addClass("input-error-line");
	$(objectClass).addClass("input-error-text");
}

function removeErrorClass(objectClass){
	$(objectClass).parent().removeClass("input-error-line");
	$(objectClass).removeClass("input-error-text");
	
}
</script>
</body>
</html>